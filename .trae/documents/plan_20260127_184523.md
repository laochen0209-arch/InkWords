# 修习页面全面优化方案

## 问题分析
1. **分类按钮无交互** - 点击分类按钮没有切换到对应内容
2. **数据与用户无关联** - 当前使用假数据，需要与用户学习进度关联
3. **顺序太刻板** - 当前按固定顺序，需要改为随机
4. **无学习记录** - 用户学过的内容没有记录，会重复出现

## 修复方案

### 1. 修复分类按钮交互
- 确保 `handleCategoryChange` 正确触发数据重新获取
- 添加分类切换时的状态重置
- 修复分类映射逻辑

### 2. 数据库模型更新
```prisma
model UserProgress {
  id        String   @id @default(cuid())
  userId    String
  itemId    String   // 词语或句子ID
  itemType  String   // "word" 或 "sentence"
  category  String
  learnedAt DateTime @default(now())
  
  @@index([userId, itemType, category])
  @@unique([userId, itemId, itemType])
}
```

### 3. API端点创建
- **POST /api/study/progress** - 记录学习进度
- **GET /api/study/progress** - 获取用户学习记录
- **GET /api/study/random** - 获取随机未学习内容

### 4. 前端逻辑重构
- 实现随机选择算法
- 学习完成后记录进度
- 全部刷完后可以重置
- 添加学习统计功能

### 5. 用户体验优化
- 添加加载状态
- 优化错误处理
- 添加学习完成提示
- 实现智能推荐

## 预期效果
- ✅ 分类按钮点击后立即切换内容
- ✅ 数据与用户真实学习进度关联
- ✅ 随机顺序，避免刻板
- ✅ 学过的内容不再重复出现
- ✅ 全部学完可以重新开始