# 实现文章详情页与点击查词功能

## 📝 任务概述
基于 Supabase `Article` 表数据结构，实现 `/app/library/[id]/page.tsx` 文章详情页，包含双语对照阅读和点击查词功能。

## 🎯 实现步骤

### 1. 创建类型定义文件
**文件**: `lib/types/article.ts`
- 定义 `Article` 接口（包含所有字段）
- 定义 `VocabularyWord` 接口（vocab_data 结构）
- 定义 `Paragraph` 接口（双语段落对齐）

### 2. 创建生词弹窗组件
**文件**: `components/library/word-popup.tsx`
- 实现点击单词后弹出的生词解释卡片
- 显示：单词、音标、释义、例句
- 支持发音功能（TTS）
- 支持添加到生词本

### 3. 创建可点击文本组件
**文件**: `components/library/clickable-text.tsx`
- 将英文文本分割为单词
- 为每个单词添加点击事件
- 点击时从 `vocab_data` 查找匹配的单词
- 触发生词弹窗显示

### 4. 重构文章详情页
**文件**: `app/library/[id]/page.tsx`
- 使用 App Router（替换旧的 Pages Router）
- 集成 API 获取文章数据
- 实现段落对齐展示（content_en 和 content_zh）
- 集成可点击文本组件
- 添加阅读工具栏（字体设置、TTS、生词本）
- 支持中/英/双语三种显示模式

### 5. 更新 API 路由（如需要）
**文件**: `app/api/articles/[id]/route.ts`
- 确保返回所有必需字段
- 验证 `vocab_data` 格式正确

## 🔧 技术要点

- **段落对齐**: 使用换行符分割 `content_en` 和 `content_zh`，按索引对应展示
- **点击查词**: 正则表达式分割单词，点击时在 `vocab_data` 中查找（忽略大小写）
- **弹窗交互**: 使用 Framer Motion 实现平滑动画
- **样式一致性**: 复用现有的墨水风格（ink-paper、ink-vermilion 等）

## 📦 预期成果

用户访问 `/library/[id]` 时：
1. 看到文章标题、分类、日期
2. 双语对照阅读（可切换显示模式）
3. 点击英文单词弹出解释卡片
4. 可调整字体大小和类型
5. 支持 TTS 朗读
6. 可将单词加入生词本